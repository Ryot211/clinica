<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="primefaces">

<ui:composition template="/templates/layout.xhtml">

    <ui:define name="titulo">Página de Citas ️</ui:define>

    <ui:define name="contenido">
        <h:form id="formMain" prependId="false">

            <p:panelGrid columns="1" layout="grid">
                <p:commandButton icon="pi pi-plus" ajax="false" value="Nuevo"
                                 actionListener="#{citaMB.nuevo(null, '/procesos/paciente.xhtml',false)}"/>
            </p:panelGrid>
            <p:dataTable rows="5" paginator="true" paginatorPosition="bottom" id="citas" widgetVar="pacientes"
                         value="#{citaMB.citas}" var="item">
                <f:facet name="header">
                    <h2>Citas</h2>
                    <p:commandButton value="Filtrar Activos" process="@this" update="citas"
                                     actionListener="#{citaMB.loadCitas('ACTIVO')}" style="width:150px;"/>
                    <p:spacer width="10"/>
                    <p:commandButton value="Imprimir " icon="pi pi-print"
                                     actionListener="#{citaMB.imprimir('ACTIVO')}" style="width:200px;"/>
                    <p:spacer width="10"/>
                    <p:commandButton value="Imprimir INACTIVOS" icon="pi pi-print"
                                     actionListener="#{citaMB.imprimir('INACTIVO')}" style="width:200px;"/>
                </f:facet>
                <p:column width="50" headerText="Fecha" filterBy="#{item.Fecha}"
                          filterMatchMode="contains">
                    <p:outputLabel value="#{item.fecha}"/>
                </p:column>
                <p:column width="50" headerText="motivo" filterBy="#{item.motivo}" filterMatchMode="contains">
                    <p:outputLabel value="#{item.motivo}"/>
                </p:column>
                <p:column width="50" headerText="Paciente">
                    <h:outputText value="#{item.id_paciente}" />
                </p:column>

                <p:column width="50" headerText="Doctor">
                    <h:outputText value="#{item.id_doctor}" />
                </p:column>

                <p:column width="25" headerText="Estado">
                    <p:outputLabel value="#{item.estado}"/>
                </p:column>

                <p:column headerText="***" width="25" style="text-align:center;">

                    <p:commandLink process="@this"
                                   actionListener="#{citaMB.nuevo(item, '/procesos/cita.xhtml',true)}">
                        <i class="pi pi-eye" style="color: purple; font-size: 1rem; margin-right: 5px;"></i>
                    </p:commandLink>
                    <h:panelGroup rendered="#{item.estado eq 'ACTIVO'}">
                        <p:commandLink process="@this"
                                       actionListener="#{citaMB.nuevo(item, '/procesos/cita.xhtml',false)}">
                            <i class="pi pi-file-edit" style="font-size: 1rem;margin-right: 5px;"></i>
                        </p:commandLink>

                        <p:commandLink>
                            <i class="pi pi-trash" style="color: red; font-size: 1rem"></i>
                        </p:commandLink>
                    </h:panelGroup>
                </p:column>

            </p:dataTable>
        </h:form>
    </ui:define>

</ui:composition>
</html>
